# Features to load from the NetFlow v2 datasets.
# IPV4_SRC_ADDR and IPV4_DST_ADDR are excluded because they are
# raw IP addresses that carry no generalizable statistical signal
# and would cause the model to overfit to specific hosts.
FEATURES = [
    "L4_SRC_PORT",
    "L4_DST_PORT",
    "PROTOCOL",
    "L7_PROTO",
    "IN_BYTES",
    "IN_PKTS",
    "OUT_BYTES",
    "OUT_PKTS",
    "TCP_FLAGS",
    "CLIENT_TCP_FLAGS",
    "SERVER_TCP_FLAGS",
    "FLOW_DURATION_MILLISECONDS",
    "DURATION_IN",
    "DURATION_OUT",
    "MIN_TTL",
    "MAX_TTL",
    "LONGEST_FLOW_PKT",
    "SHORTEST_FLOW_PKT",
    "MIN_IP_PKT_LEN",
    "MAX_IP_PKT_LEN",
    "SRC_TO_DST_SECOND_BYTES",
    "DST_TO_SRC_SECOND_BYTES",
    "RETRANSMITTED_IN_BYTES",
    "RETRANSMITTED_IN_PKTS",
    "RETRANSMITTED_OUT_BYTES",
    "RETRANSMITTED_OUT_PKTS",
    "SRC_TO_DST_AVG_THROUGHPUT",
    "DST_TO_SRC_AVG_THROUGHPUT",
    "NUM_PKTS_UP_TO_128_BYTES",
    "NUM_PKTS_128_TO_256_BYTES",
    "NUM_PKTS_256_TO_512_BYTES",
    "NUM_PKTS_512_TO_1024_BYTES",
    "NUM_PKTS_1024_TO_1514_BYTES",
    "TCP_WIN_MAX_IN",
    "TCP_WIN_MAX_OUT",
    "ICMP_TYPE",
    "ICMP_IPV4_TYPE",
    "DNS_QUERY_ID",
    "DNS_QUERY_TYPE",
    "DNS_TTL_ANSWER",
    "FTP_COMMAND_RET_CODE",
]

LABEL_COL = "Label"
ATTACK_COL = "Attack"

DATASETS = [
    "dataset/NF-BoT-IoT-v2.csv",
    "dataset/NF-CSE-CIC-IDS2018-v2.csv",
    "dataset/NF-ToN-IoT-v2.csv",
    "dataset/NF-UNSW-NB15-v2.csv",
]

# Mapping of all known L7_PROTO float values to sequential categorical uint16 IDs.
# Values were collected from all four NetFlow v2 datasets.
# L7_PROTO_UNKNOWN is used for any value not seen during training.
L7_PROTO_UNKNOWN: int = 368
L7_PROTO_MAP: dict[float, int] = {
    0.0: 0,
    1.0: 1,
    1.178: 2,
    1.7: 3,
    2.0: 4,
    2.178: 5,
    2.7: 6,
    3.0: 7,
    3.125: 8,
    3.178: 9,
    3.7: 10,
    4.0: 11,
    4.178: 12,
    4.7: 13,
    5.0: 14,
    5.118: 15,
    5.119: 16,
    5.12: 17,
    5.121: 18,
    5.122000000000001: 19,
    5.122999999999998: 20,
    5.124: 21,
    5.125: 22,
    5.126: 23,
    5.132999999999999: 24,
    5.1370000000000005: 25,
    5.14: 26,
    5.141: 27,
    5.142: 28,
    5.143: 29,
    5.145: 30,
    5.147: 31,
    5.1560000000000015: 32,
    5.157: 33,
    5.162999999999999: 34,
    5.169: 35,
    5.176: 36,
    5.178: 37,
    5.178999999999999: 38,
    5.18: 39,
    5.187: 40,
    5.191: 41,
    5.195: 42,
    5.199: 43,
    5.2: 44,
    5.202999999999999: 45,
    5.21: 46,
    5.211: 47,
    5.2120000000000015: 48,
    5.215: 49,
    5.2170000000000005: 50,
    5.218999999999999: 51,
    5.22: 52,
    5.221: 53,
    5.224: 54,
    5.225: 55,
    5.231: 56,
    5.233: 57,
    5.234: 58,
    5.239: 59,
    5.24: 60,
    5.2410000000000005: 61,
    5.246: 62,
    5.26: 63,
    5.47: 64,
    5.48: 65,
    5.68: 66,
    5.7: 67,
    5.72: 68,
    5.74: 69,
    7.0: 70,
    7.119: 71,
    7.12: 72,
    7.1229999999999976: 73,
    7.124: 74,
    7.125: 75,
    7.126: 76,
    7.13: 77,
    7.131: 78,
    7.132999999999999: 79,
    7.1370000000000005: 80,
    7.14: 81,
    7.141: 82,
    7.147: 83,
    7.162999999999999: 84,
    7.169: 85,
    7.178: 86,
    7.178999999999999: 87,
    7.18: 88,
    7.191: 89,
    7.195: 90,
    7.197: 91,
    7.2: 92,
    7.202999999999999: 93,
    7.211: 94,
    7.2120000000000015: 95,
    7.212999999999999: 96,
    7.2189999999999985: 97,
    7.22: 98,
    7.221: 99,
    7.225: 100,
    7.233: 101,
    7.239: 102,
    7.24: 103,
    7.246: 104,
    7.26: 105,
    7.47: 106,
    7.48: 107,
    7.5: 108,
    7.68: 109,
    7.7: 110,
    7.74: 111,
    8.0: 112,
    9.0: 113,
    9.125: 114,
    9.169: 115,
    9.178: 116,
    10.0: 117,
    10.178: 118,
    11.0: 119,
    11.178: 120,
    13.0: 121,
    13.178: 122,
    14.0: 123,
    14.178: 124,
    15.0: 125,
    15.178: 126,
    17.0: 127,
    17.178: 128,
    18.0: 129,
    19.0: 130,
    19.178: 131,
    19.7: 132,
    20.0: 133,
    20.125: 134,
    23.0: 135,
    23.7: 136,
    27.0: 137,
    28.0: 138,
    29.0: 139,
    29.178: 140,
    29.7: 141,
    31.0: 142,
    37.0: 143,
    37.7: 144,
    40.0: 145,
    40.178: 146,
    41.0: 147,
    41.125: 148,
    41.163: 149,
    41.178: 150,
    41.215: 151,
    41.7: 152,
    42.0: 153,
    43.0: 154,
    44.0: 155,
    44.178: 156,
    47.0: 157,
    47.178: 158,
    50.0: 159,
    50.12600000000001: 160,
    50.7: 161,
    51.0: 162,
    51.7: 163,
    65.0: 164,
    65.178: 165,
    66.0: 166,
    74.0: 167,
    77.0: 168,
    77.125: 169,
    77.178: 170,
    78.0: 171,
    78.178: 172,
    78.20100000000002: 173,
    78.39: 174,
    78.45: 175,
    79.0: 176,
    79.178: 177,
    81.119: 178,
    81.125: 179,
    81.126: 180,
    81.169: 181,
    81.178: 182,
    81.212: 183,
    81.219: 184,
    81.22: 185,
    81.221: 186,
    84.0: 187,
    85.0: 188,
    85.178: 189,
    88.0: 190,
    88.125: 191,
    88.126: 192,
    88.178: 193,
    88.7: 194,
    89.0: 195,
    89.126: 196,
    89.178: 197,
    89.7: 198,
    91.0: 199,
    91.118: 200,
    91.119: 201,
    91.12: 202,
    91.121: 203,
    91.122: 204,
    91.123: 205,
    91.124: 206,
    91.125: 207,
    91.126: 208,
    91.133: 209,
    91.137: 210,
    91.14: 211,
    91.141: 212,
    91.142: 213,
    91.143: 214,
    91.145: 215,
    91.147: 216,
    91.156: 217,
    91.163: 218,
    91.169: 219,
    91.176: 220,
    91.178: 221,
    91.179: 222,
    91.18: 223,
    91.185: 224,
    91.187: 225,
    91.195: 226,
    91.197: 227,
    91.199: 228,
    91.2: 229,
    91.203: 230,
    91.21: 231,
    91.211: 232,
    91.212: 233,
    91.215: 234,
    91.217: 235,
    91.219: 236,
    91.22: 237,
    91.221: 238,
    91.23: 239,
    91.231: 240,
    91.233: 241,
    91.234: 242,
    91.239: 243,
    91.24: 244,
    91.241: 245,
    91.246: 246,
    91.26: 247,
    91.29: 248,
    91.47: 249,
    91.48: 250,
    91.51: 251,
    91.68: 252,
    91.7: 253,
    91.72: 254,
    91.74: 255,
    92.0: 256,
    92.125: 257,
    92.126: 258,
    92.178: 259,
    92.7: 260,
    95.0: 261,
    95.178: 262,
    96.0: 263,
    97.0: 264,
    97.178: 265,
    100.0: 266,
    100.163: 267,
    100.178: 268,
    111.0: 269,
    111.178: 270,
    111.7: 271,
    112.0: 272,
    112.178: 273,
    114.0: 274,
    114.178: 275,
    125.0: 276,
    125.38: 277,
    126.0: 278,
    127.0: 279,
    127.178: 280,
    131.0: 281,
    131.125: 282,
    131.126: 283,
    131.178: 284,
    131.22: 285,
    131.7: 286,
    132.0: 287,
    138.0: 288,
    139.0: 289,
    139.7: 290,
    144.0: 291,
    146.0: 292,
    146.178: 293,
    148.0: 294,
    150.0: 295,
    150.178: 296,
    151.0: 297,
    151.178: 298,
    152.0: 299,
    153.0: 300,
    153.178: 301,
    154.0: 302,
    155.0: 303,
    155.178: 304,
    158.0: 305,
    158.178: 306,
    159.0: 307,
    161.0: 308,
    161.7: 309,
    163.0: 310,
    164.0: 311,
    164.178: 312,
    166.0: 313,
    166.178: 314,
    167.0: 315,
    167.178: 316,
    170.0: 317,
    170.12599999999995: 318,
    170.178: 319,
    170.22: 320,
    171.0: 321,
    172.0: 322,
    172.178: 323,
    174.0: 324,
    174.178: 325,
    175.0: 326,
    175.178: 327,
    178.0: 328,
    182.0: 329,
    182.126: 330,
    182.178: 331,
    184.0: 332,
    188.0: 333,
    188.123: 334,
    188.124: 335,
    188.126: 336,
    188.217: 337,
    188.239: 338,
    188.241: 339,
    188.39: 340,
    190.0: 341,
    196.0: 342,
    196.178: 343,
    204.0: 344,
    206.0: 345,
    209.0: 346,
    213.0: 347,
    213.178: 348,
    219.0: 349,
    222.0: 350,
    222.178: 351,
    222.7: 352,
    226.0: 353,
    229.0: 354,
    231.0: 355,
    231.178: 356,
    237.0: 357,
    237.178: 358,
    237.7: 359,
    238.0: 360,
    238.178: 361,
    243.178: 362,
    244.0: 363,
    245.0: 364,
    245.178: 365,
    247.0: 366,
    248.0: 367,
}

MAX_LEAVES = [
    32,64,128,256,512,1024,2048
]

N_ESTIMATORS = [5, 9, 13]
