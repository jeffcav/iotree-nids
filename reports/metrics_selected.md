# Model Comparison â€“ LightGBM on NetFlow v2 Datasets

Metrics are **weighted** averages of per-class precision, recall and F1-score on the held-out 30 % test split.

Feature set: `selected`

Average strategy: `binary`


## NF-BoT-IoT-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9277 | 0.9463 | 0.9729 |
|                     64 | 0.9852 | 0.9619 | 0.9780 |
|                    128 | 0.9225 | 0.9681 | 0.9638 |
|                    256 | 0.8558 | 0.9578 | 0.9605 |
|                    512 | 0.9532 | 0.9512 | 0.9528 |
|                   1024 | 0.9402 | 0.9814 | 0.9761 |
|                   2048 | 0.9402 | 0.9814 | 0.9761 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9999 | 0.9998 | 0.9998 |
|                     64 | 0.9998 | 0.9998 | 0.9998 |
|                    128 | 0.9999 | 0.9999 | 0.9999 |
|                    256 | 0.9999 | 0.9999 | 0.9999 |
|                    512 | 0.9999 | 0.9999 | 0.9999 |
|                   1024 | 0.9999 | 0.9999 | 0.9999 |
|                   2048 | 0.9999 | 0.9999 | 0.9999 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9624 | 0.9723 | 0.9862 |
|                     64 | 0.9925 | 0.9805 | 0.9888 |
|                    128 | 0.9597 | 0.9838 | 0.9815 |
|                    256 | 0.9222 | 0.9784 | 0.9798 |
|                    512 | 0.9760 | 0.9749 | 0.9758 |
|                   1024 | 0.9691 | 0.9906 | 0.9879 |
|                   2048 | 0.9691 | 0.9906 | 0.9879 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9652 | 0.7659 | 0.7929 |
|                     64 | 0.9300 | 0.9540 | 0.9499 |
|                    128 | 0.9508 | 0.9121 | 0.9480 |
|                    256 | 0.9545 | 0.9522 | 0.9707 |
|                    512 | 0.9346 | 0.9538 | 0.9593 |
|                   1024 | 0.9509 | 0.9526 | 0.9597 |
|                   2048 | 0.9509 | 0.9520 | 0.9576 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9997 | 0.9998 | 0.9998 |
|                     64 | 0.9999 | 0.9998 | 0.9998 |
|                    128 | 0.9999 | 0.9999 | 0.9999 |
|                    256 | 0.9999 | 0.9999 | 0.9999 |
|                    512 | 0.9999 | 0.9999 | 0.9999 |
|                   1024 | 0.9999 | 0.9999 | 0.9999 |
|                   2048 | 0.9999 | 0.9999 | 0.9999 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9821 | 0.8673 | 0.8844 |
|                     64 | 0.9637 | 0.9764 | 0.9742 |
|                    128 | 0.9747 | 0.9540 | 0.9732 |
|                    256 | 0.9767 | 0.9755 | 0.9851 |
|                    512 | 0.9661 | 0.9763 | 0.9792 |
|                   1024 | 0.9748 | 0.9757 | 0.9794 |
|                   2048 | 0.9748 | 0.9754 | 0.9783 |


### Best configuration by F1-score (NF-BoT-IoT-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |           64 |              5 |      0.9852 |   0.9998 |     0.9925 |
| integer |          256 |             13 |      0.9707 |   0.9999 |     0.9851 |



## NF-CSE-CIC-IDS2018-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9999 | 1.0000 | 1.0000 |
|                     64 | 1.0000 | 1.0000 | 1.0000 |
|                    128 | 1.0000 | 1.0000 | 1.0000 |
|                    256 | 1.0000 | 1.0000 | 1.0000 |
|                    512 | 1.0000 | 1.0000 | 1.0000 |
|                   1024 | 1.0000 | 1.0000 | 1.0000 |
|                   2048 | 1.0000 | 1.0000 | 1.0000 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9552 | 0.9583 | 0.9598 |
|                     64 | 0.9582 | 0.9595 | 0.9621 |
|                    128 | 0.9598 | 0.9640 | 0.9648 |
|                    256 | 0.9619 | 0.9645 | 0.9651 |
|                    512 | 0.9623 | 0.9650 | 0.9652 |
|                   1024 | 0.9627 | 0.9651 | 0.9653 |
|                   2048 | 0.9629 | 0.9651 | 0.9654 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9771 | 0.9787 | 0.9795 |
|                     64 | 0.9787 | 0.9793 | 0.9806 |
|                    128 | 0.9795 | 0.9817 | 0.9821 |
|                    256 | 0.9806 | 0.9819 | 0.9822 |
|                    512 | 0.9808 | 0.9822 | 0.9823 |
|                   1024 | 0.9810 | 0.9822 | 0.9823 |
|                   2048 | 0.9811 | 0.9822 | 0.9824 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 1.0000 | 1.0000 | 1.0000 |
|                     64 | 1.0000 | 1.0000 | 0.9999 |
|                    128 | 1.0000 | 1.0000 | 1.0000 |
|                    256 | 1.0000 | 1.0000 | 1.0000 |
|                    512 | 1.0000 | 1.0000 | 1.0000 |
|                   1024 | 1.0000 | 1.0000 | 1.0000 |
|                   2048 | 1.0000 | 1.0000 | 1.0000 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9567 | 0.9573 | 0.9594 |
|                     64 | 0.9588 | 0.9608 | 0.9627 |
|                    128 | 0.9599 | 0.9643 | 0.9646 |
|                    256 | 0.9629 | 0.9647 | 0.9651 |
|                    512 | 0.9633 | 0.9652 | 0.9654 |
|                   1024 | 0.9636 | 0.9652 | 0.9655 |
|                   2048 | 0.9637 | 0.9652 | 0.9655 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9779 | 0.9782 | 0.9793 |
|                     64 | 0.9789 | 0.9800 | 0.9810 |
|                    128 | 0.9795 | 0.9818 | 0.9819 |
|                    256 | 0.9811 | 0.9820 | 0.9822 |
|                    512 | 0.9813 | 0.9823 | 0.9824 |
|                   1024 | 0.9815 | 0.9823 | 0.9824 |
|                   2048 | 0.9815 | 0.9823 | 0.9824 |


### Best configuration by F1-score (NF-CSE-CIC-IDS2018-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |         2048 |             13 |      1.0000 |   0.9654 |     0.9824 |
| integer |         2048 |             13 |      1.0000 |   0.9655 |     0.9824 |



## NF-ToN-IoT-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9360 | 0.9644 | 0.9687 |
|                     64 | 0.9567 | 0.9775 | 0.9786 |
|                    128 | 0.9774 | 0.9808 | 0.9841 |
|                    256 | 0.9831 | 0.9859 | 0.9872 |
|                    512 | 0.9865 | 0.9889 | 0.9897 |
|                   1024 | 0.9886 | 0.9909 | 0.9918 |
|                   2048 | 0.9905 | 0.9921 | 0.9926 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9963 | 0.9904 | 0.9891 |
|                     64 | 0.9969 | 0.9923 | 0.9925 |
|                    128 | 0.9968 | 0.9957 | 0.9952 |
|                    256 | 0.9980 | 0.9972 | 0.9970 |
|                    512 | 0.9983 | 0.9978 | 0.9976 |
|                   1024 | 0.9986 | 0.9981 | 0.9981 |
|                   2048 | 0.9988 | 0.9983 | 0.9982 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9652 | 0.9772 | 0.9788 |
|                     64 | 0.9764 | 0.9848 | 0.9855 |
|                    128 | 0.9870 | 0.9882 | 0.9896 |
|                    256 | 0.9905 | 0.9916 | 0.9921 |
|                    512 | 0.9923 | 0.9933 | 0.9937 |
|                   1024 | 0.9935 | 0.9945 | 0.9949 |
|                   2048 | 0.9946 | 0.9952 | 0.9954 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9249 | 0.9454 | 0.9496 |
|                     64 | 0.9389 | 0.9507 | 0.9615 |
|                    128 | 0.9535 | 0.9627 | 0.9642 |
|                    256 | 0.9547 | 0.9620 | 0.9659 |
|                    512 | 0.9594 | 0.9656 | 0.9682 |
|                   1024 | 0.9629 | 0.9685 | 0.9696 |
|                   2048 | 0.9645 | 0.9690 | 0.9700 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9970 | 0.9930 | 0.9920 |
|                     64 | 0.9987 | 0.9952 | 0.9914 |
|                    128 | 0.9975 | 0.9938 | 0.9934 |
|                    256 | 0.9980 | 0.9958 | 0.9945 |
|                    512 | 0.9978 | 0.9961 | 0.9951 |
|                   1024 | 0.9979 | 0.9961 | 0.9959 |
|                   2048 | 0.9981 | 0.9967 | 0.9963 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9596 | 0.9686 | 0.9703 |
|                     64 | 0.9679 | 0.9724 | 0.9762 |
|                    128 | 0.9750 | 0.9780 | 0.9786 |
|                    256 | 0.9759 | 0.9786 | 0.9800 |
|                    512 | 0.9782 | 0.9806 | 0.9815 |
|                   1024 | 0.9801 | 0.9821 | 0.9825 |
|                   2048 | 0.9810 | 0.9826 | 0.9829 |


### Best configuration by F1-score (NF-ToN-IoT-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |         2048 |             13 |      0.9926 |   0.9982 |     0.9954 |
| integer |         2048 |             13 |      0.9700 |   0.9963 |     0.9829 |



## NF-UNSW-NB15-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9991 | 0.9983 | 0.9982 |
|                     64 | 0.9992 | 0.9985 | 0.9985 |
|                    128 | 0.9992 | 0.9987 | 0.9985 |
|                    256 | 0.9992 | 0.9988 | 0.9986 |
|                    512 | 0.9992 | 0.9989 | 0.9986 |
|                   1024 | 0.9993 | 0.9989 | 0.9986 |
|                   2048 | 0.9993 | 0.9989 | 0.9986 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.8492 | 0.9686 | 0.9731 |
|                     64 | 0.8706 | 0.9636 | 0.9702 |
|                    128 | 0.8886 | 0.9614 | 0.9707 |
|                    256 | 0.9074 | 0.9590 | 0.9699 |
|                    512 | 0.9046 | 0.9539 | 0.9681 |
|                   1024 | 0.8691 | 0.9511 | 0.9672 |
|                   2048 | 0.8703 | 0.9530 | 0.9669 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9180 | 0.9832 | 0.9855 |
|                     64 | 0.9305 | 0.9807 | 0.9841 |
|                    128 | 0.9407 | 0.9797 | 0.9844 |
|                    256 | 0.9511 | 0.9785 | 0.9840 |
|                    512 | 0.9496 | 0.9759 | 0.9831 |
|                   1024 | 0.9296 | 0.9744 | 0.9827 |
|                   2048 | 0.9303 | 0.9754 | 0.9825 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9991 | 0.9984 | 0.9981 |
|                     64 | 0.9992 | 0.9985 | 0.9984 |
|                    128 | 0.9992 | 0.9987 | 0.9985 |
|                    256 | 0.9992 | 0.9988 | 0.9987 |
|                    512 | 0.9992 | 0.9989 | 0.9987 |
|                   1024 | 0.9993 | 0.9989 | 0.9987 |
|                   2048 | 0.9993 | 0.9989 | 0.9987 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.8667 | 0.9661 | 0.9746 |
|                     64 | 0.8757 | 0.9667 | 0.9719 |
|                    128 | 0.8980 | 0.9644 | 0.9705 |
|                    256 | 0.9102 | 0.9589 | 0.9700 |
|                    512 | 0.9006 | 0.9562 | 0.9682 |
|                   1024 | 0.8660 | 0.9521 | 0.9671 |
|                   2048 | 0.8680 | 0.9522 | 0.9667 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9282 | 0.9820 | 0.9862 |
|                     64 | 0.9334 | 0.9824 | 0.9850 |
|                    128 | 0.9459 | 0.9812 | 0.9843 |
|                    256 | 0.9527 | 0.9784 | 0.9841 |
|                    512 | 0.9474 | 0.9771 | 0.9832 |
|                   1024 | 0.9279 | 0.9750 | 0.9827 |
|                   2048 | 0.9291 | 0.9750 | 0.9824 |


### Best configuration by F1-score (NF-UNSW-NB15-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |           32 |             13 |      0.9982 |   0.9731 |     0.9855 |
| integer |           32 |             13 |      0.9981 |   0.9746 |     0.9862 |



## Overall Best Model per Dataset

| dataset               | mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:----------------------|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| NF-BoT-IoT-v2         | float   |           64 |              5 |      0.9852 |   0.9998 |     0.9925 |
| NF-CSE-CIC-IDS2018-v2 | integer |         2048 |             13 |      1.0000 |   0.9655 |     0.9824 |
| NF-ToN-IoT-v2         | float   |         2048 |             13 |      0.9926 |   0.9982 |     0.9954 |
| NF-UNSW-NB15-v2       | integer |           32 |             13 |      0.9981 |   0.9746 |     0.9862 |

