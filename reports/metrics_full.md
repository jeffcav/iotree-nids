# Model Comparison â€“ LightGBM on NetFlow v2 Datasets

Metrics are **weighted** averages of per-class precision, recall and F1-score on the held-out 30 % test split.

Feature set: `full`

Average strategy: `binary`


## NF-BoT-IoT-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9883 | 0.9914 | 0.9390 |
|                     64 | 0.9322 | 0.9637 | 0.9576 |
|                    128 | 0.9601 | 0.9584 | 0.9521 |
|                    256 | 0.9556 | 0.9741 | 0.9670 |
|                    512 | 0.9701 | 0.9656 | 0.9748 |
|                   1024 | 0.9566 | 0.9780 | 0.9652 |
|                   2048 | 0.9566 | 0.9774 | 0.9664 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9998 | 0.9998 | 0.9999 |
|                     64 | 0.9999 | 0.9999 | 0.9999 |
|                    128 | 0.9999 | 0.9999 | 0.9999 |
|                    256 | 0.9999 | 0.9999 | 0.9999 |
|                    512 | 0.9999 | 0.9999 | 0.9999 |
|                   1024 | 0.9999 | 0.9999 | 0.9999 |
|                   2048 | 0.9999 | 0.9999 | 0.9999 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9940 | 0.9956 | 0.9685 |
|                     64 | 0.9648 | 0.9814 | 0.9783 |
|                    128 | 0.9796 | 0.9787 | 0.9754 |
|                    256 | 0.9773 | 0.9869 | 0.9832 |
|                    512 | 0.9848 | 0.9825 | 0.9872 |
|                   1024 | 0.9778 | 0.9888 | 0.9822 |
|                   2048 | 0.9778 | 0.9885 | 0.9829 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9775 | 0.9517 | 0.7694 |
|                     64 | 0.9752 | 0.9634 | 0.9725 |
|                    128 | 0.8740 | 0.9357 | 0.9703 |
|                    256 | 0.9748 | 0.9742 | 0.9543 |
|                    512 | 0.9349 | 0.9699 | 0.9802 |
|                   1024 | 0.9226 | 0.9437 | 0.9639 |
|                   2048 | 0.9226 | 0.9447 | 0.9673 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9998 | 0.9999 | 0.9999 |
|                     64 | 0.9999 | 0.9999 | 0.9998 |
|                    128 | 0.9999 | 0.9999 | 0.9998 |
|                    256 | 0.9999 | 0.9999 | 0.9999 |
|                    512 | 0.9999 | 0.9999 | 0.9999 |
|                   1024 | 0.9999 | 0.9999 | 0.9999 |
|                   2048 | 0.9999 | 0.9999 | 0.9999 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9885 | 0.9752 | 0.8696 |
|                     64 | 0.9874 | 0.9813 | 0.9860 |
|                    128 | 0.9327 | 0.9667 | 0.9849 |
|                    256 | 0.9872 | 0.9869 | 0.9766 |
|                    512 | 0.9663 | 0.9847 | 0.9900 |
|                   1024 | 0.9597 | 0.9710 | 0.9816 |
|                   2048 | 0.9597 | 0.9715 | 0.9833 |


### Best configuration by F1-score (NF-BoT-IoT-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |           32 |              9 |      0.9914 |   0.9998 |     0.9956 |
| integer |          512 |             13 |      0.9802 |   0.9999 |     0.9900 |



## NF-CSE-CIC-IDS2018-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 1.0000 | 1.0000 | 1.0000 |
|                     64 | 1.0000 | 1.0000 | 1.0000 |
|                    128 | 1.0000 | 1.0000 | 1.0000 |
|                    256 | 1.0000 | 1.0000 | 1.0000 |
|                    512 | 1.0000 | 1.0000 | 1.0000 |
|                   1024 | 1.0000 | 1.0000 | 1.0000 |
|                   2048 | 1.0000 | 1.0000 | 1.0000 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9579 | 0.9599 | 0.9599 |
|                     64 | 0.9595 | 0.9617 | 0.9625 |
|                    128 | 0.9602 | 0.9640 | 0.9648 |
|                    256 | 0.9626 | 0.9651 | 0.9653 |
|                    512 | 0.9629 | 0.9653 | 0.9655 |
|                   1024 | 0.9637 | 0.9655 | 0.9657 |
|                   2048 | 0.9637 | 0.9655 | 0.9658 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9785 | 0.9795 | 0.9795 |
|                     64 | 0.9793 | 0.9805 | 0.9809 |
|                    128 | 0.9797 | 0.9817 | 0.9820 |
|                    256 | 0.9809 | 0.9823 | 0.9823 |
|                    512 | 0.9811 | 0.9823 | 0.9824 |
|                   1024 | 0.9815 | 0.9824 | 0.9825 |
|                   2048 | 0.9815 | 0.9824 | 0.9826 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 1.0000 | 1.0000 | 1.0000 |
|                     64 | 1.0000 | 1.0000 | 1.0000 |
|                    128 | 1.0000 | 1.0000 | 1.0000 |
|                    256 | 1.0000 | 1.0000 | 1.0000 |
|                    512 | 1.0000 | 1.0000 | 1.0000 |
|                   1024 | 1.0000 | 1.0000 | 1.0000 |
|                   2048 | 1.0000 | 1.0000 | 1.0000 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9554 | 0.9577 | 0.9596 |
|                     64 | 0.9591 | 0.9607 | 0.9621 |
|                    128 | 0.9608 | 0.9643 | 0.9648 |
|                    256 | 0.9627 | 0.9651 | 0.9653 |
|                    512 | 0.9633 | 0.9653 | 0.9656 |
|                   1024 | 0.9639 | 0.9655 | 0.9658 |
|                   2048 | 0.9638 | 0.9656 | 0.9659 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9772 | 0.9784 | 0.9793 |
|                     64 | 0.9791 | 0.9799 | 0.9807 |
|                    128 | 0.9800 | 0.9818 | 0.9821 |
|                    256 | 0.9810 | 0.9822 | 0.9823 |
|                    512 | 0.9813 | 0.9823 | 0.9825 |
|                   1024 | 0.9816 | 0.9825 | 0.9826 |
|                   2048 | 0.9816 | 0.9825 | 0.9826 |


### Best configuration by F1-score (NF-CSE-CIC-IDS2018-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |         2048 |             13 |      1.0000 |   0.9658 |     0.9826 |
| integer |         2048 |             13 |      1.0000 |   0.9659 |     0.9826 |



## NF-ToN-IoT-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9476 | 0.9634 | 0.9706 |
|                     64 | 0.9666 | 0.9756 | 0.9776 |
|                    128 | 0.9770 | 0.9807 | 0.9837 |
|                    256 | 0.9844 | 0.9867 | 0.9878 |
|                    512 | 0.9869 | 0.9892 | 0.9900 |
|                   1024 | 0.9890 | 0.9907 | 0.9920 |
|                   2048 | 0.9911 | 0.9924 | 0.9930 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9958 | 0.9939 | 0.9917 |
|                     64 | 0.9969 | 0.9948 | 0.9955 |
|                    128 | 0.9979 | 0.9972 | 0.9966 |
|                    256 | 0.9981 | 0.9977 | 0.9976 |
|                    512 | 0.9986 | 0.9982 | 0.9980 |
|                   1024 | 0.9989 | 0.9985 | 0.9984 |
|                   2048 | 0.9990 | 0.9987 | 0.9986 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9711 | 0.9784 | 0.9810 |
|                     64 | 0.9815 | 0.9851 | 0.9865 |
|                    128 | 0.9873 | 0.9889 | 0.9901 |
|                    256 | 0.9912 | 0.9922 | 0.9927 |
|                    512 | 0.9927 | 0.9937 | 0.9940 |
|                   1024 | 0.9939 | 0.9946 | 0.9952 |
|                   2048 | 0.9950 | 0.9955 | 0.9958 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9372 | 0.9620 | 0.9655 |
|                     64 | 0.9625 | 0.9682 | 0.9710 |
|                    128 | 0.9733 | 0.9782 | 0.9794 |
|                    256 | 0.9782 | 0.9805 | 0.9815 |
|                    512 | 0.9810 | 0.9836 | 0.9847 |
|                   1024 | 0.9840 | 0.9862 | 0.9867 |
|                   2048 | 0.9847 | 0.9867 | 0.9873 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9962 | 0.9926 | 0.9917 |
|                     64 | 0.9970 | 0.9956 | 0.9960 |
|                    128 | 0.9976 | 0.9967 | 0.9965 |
|                    256 | 0.9979 | 0.9972 | 0.9971 |
|                    512 | 0.9983 | 0.9977 | 0.9974 |
|                   1024 | 0.9985 | 0.9979 | 0.9978 |
|                   2048 | 0.9988 | 0.9982 | 0.9980 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9658 | 0.9771 | 0.9785 |
|                     64 | 0.9794 | 0.9817 | 0.9834 |
|                    128 | 0.9853 | 0.9874 | 0.9879 |
|                    256 | 0.9880 | 0.9888 | 0.9892 |
|                    512 | 0.9896 | 0.9906 | 0.9910 |
|                   1024 | 0.9912 | 0.9920 | 0.9922 |
|                   2048 | 0.9917 | 0.9924 | 0.9926 |


### Best configuration by F1-score (NF-ToN-IoT-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |         2048 |             13 |      0.9930 |   0.9986 |     0.9958 |
| integer |         2048 |             13 |      0.9873 |   0.9980 |     0.9926 |



## NF-UNSW-NB15-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9991 | 0.9984 | 0.9982 |
|                     64 | 0.9992 | 0.9985 | 0.9984 |
|                    128 | 0.9992 | 0.9987 | 0.9986 |
|                    256 | 0.9992 | 0.9988 | 0.9987 |
|                    512 | 0.9992 | 0.9989 | 0.9987 |
|                   1024 | 0.9993 | 0.9989 | 0.9987 |
|                   2048 | 0.9993 | 0.9989 | 0.9987 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.8736 | 0.9686 | 0.9747 |
|                     64 | 0.8906 | 0.9664 | 0.9712 |
|                    128 | 0.8928 | 0.9612 | 0.9682 |
|                    256 | 0.9117 | 0.9582 | 0.9670 |
|                    512 | 0.9004 | 0.9543 | 0.9667 |
|                   1024 | 0.8698 | 0.9540 | 0.9663 |
|                   2048 | 0.8709 | 0.9535 | 0.9666 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9322 | 0.9833 | 0.9863 |
|                     64 | 0.9418 | 0.9822 | 0.9846 |
|                    128 | 0.9430 | 0.9796 | 0.9832 |
|                    256 | 0.9535 | 0.9781 | 0.9826 |
|                    512 | 0.9473 | 0.9761 | 0.9825 |
|                   1024 | 0.9300 | 0.9759 | 0.9822 |
|                   2048 | 0.9307 | 0.9757 | 0.9824 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9991 | 0.9984 | 0.9982 |
|                     64 | 0.9992 | 0.9986 | 0.9985 |
|                    128 | 0.9993 | 0.9987 | 0.9986 |
|                    256 | 0.9992 | 0.9988 | 0.9986 |
|                    512 | 0.9992 | 0.9988 | 0.9987 |
|                   1024 | 0.9992 | 0.9989 | 0.9987 |
|                   2048 | 0.9992 | 0.9989 | 0.9987 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.8755 | 0.9686 | 0.9744 |
|                     64 | 0.8813 | 0.9655 | 0.9699 |
|                    128 | 0.8978 | 0.9635 | 0.9701 |
|                    256 | 0.9048 | 0.9581 | 0.9669 |
|                    512 | 0.9009 | 0.9529 | 0.9672 |
|                   1024 | 0.8668 | 0.9525 | 0.9660 |
|                   2048 | 0.8682 | 0.9527 | 0.9663 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9332 | 0.9832 | 0.9862 |
|                     64 | 0.9365 | 0.9818 | 0.9840 |
|                    128 | 0.9458 | 0.9808 | 0.9841 |
|                    256 | 0.9497 | 0.9780 | 0.9825 |
|                    512 | 0.9475 | 0.9753 | 0.9827 |
|                   1024 | 0.9283 | 0.9751 | 0.9821 |
|                   2048 | 0.9291 | 0.9752 | 0.9822 |


### Best configuration by F1-score (NF-UNSW-NB15-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |           32 |             13 |      0.9982 |   0.9747 |     0.9863 |
| integer |           32 |             13 |      0.9982 |   0.9744 |     0.9862 |



## Overall Best Model per Dataset

| dataset               | mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:----------------------|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| NF-BoT-IoT-v2         | float   |           32 |              9 |      0.9914 |   0.9998 |     0.9956 |
| NF-CSE-CIC-IDS2018-v2 | integer |         2048 |             13 |      1.0000 |   0.9659 |     0.9826 |
| NF-ToN-IoT-v2         | float   |         2048 |             13 |      0.9930 |   0.9986 |     0.9958 |
| NF-UNSW-NB15-v2       | float   |           32 |             13 |      0.9982 |   0.9747 |     0.9863 |

