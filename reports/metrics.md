# Model Comparison â€“ LightGBM on NetFlow v2 Datasets

Metrics are **weighted** averages of per-class precision, recall and F1-score on the held-out 30 % test split.

Average strategy: `binary`


## NF-BoT-IoT-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9883 | 0.9914 | 0.9390 |
|                     64 | 0.9322 | 0.9637 | 0.9576 |
|                    128 | 0.9601 | 0.9584 | 0.9521 |
|                    256 | 0.9556 | 0.9741 | 0.9670 |
|                    512 | 0.9701 | 0.9656 | 0.9748 |
|                   1024 | 0.9566 | 0.9780 | 0.9652 |
|                   2048 | 0.9566 | 0.9774 | 0.9664 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9998 | 0.9998 | 0.9999 |
|                     64 | 0.9999 | 0.9999 | 0.9999 |
|                    128 | 0.9999 | 0.9999 | 0.9999 |
|                    256 | 0.9999 | 0.9999 | 0.9999 |
|                    512 | 0.9999 | 0.9999 | 0.9999 |
|                   1024 | 0.9999 | 0.9999 | 0.9999 |
|                   2048 | 0.9999 | 0.9999 | 0.9999 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9940 | 0.9956 | 0.9685 |
|                     64 | 0.9648 | 0.9814 | 0.9783 |
|                    128 | 0.9796 | 0.9787 | 0.9754 |
|                    256 | 0.9773 | 0.9869 | 0.9832 |
|                    512 | 0.9848 | 0.9825 | 0.9872 |
|                   1024 | 0.9778 | 0.9888 | 0.9822 |
|                   2048 | 0.9778 | 0.9885 | 0.9829 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9542 | 0.8895 | 0.9412 |
|                     64 | 0.9709 | 0.9696 | 0.9603 |
|                    128 | 0.9321 | 0.9586 | 0.9717 |
|                    256 | 0.9673 | 0.9601 | 0.9526 |
|                    512 | 0.9582 | 0.9669 | 0.9683 |
|                   1024 | 0.9582 | 0.9705 | 0.9795 |
|                   2048 | 0.9582 | 0.9763 | 0.9757 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9998 | 0.9998 | 0.9998 |
|                     64 | 0.9999 | 0.9999 | 0.9998 |
|                    128 | 0.9999 | 0.9999 | 0.9999 |
|                    256 | 0.9999 | 0.9999 | 0.9999 |
|                    512 | 0.9999 | 0.9999 | 0.9999 |
|                   1024 | 0.9999 | 0.9999 | 0.9999 |
|                   2048 | 0.9999 | 0.9999 | 0.9999 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9765 | 0.9414 | 0.9696 |
|                     64 | 0.9852 | 0.9845 | 0.9797 |
|                    128 | 0.9648 | 0.9788 | 0.9856 |
|                    256 | 0.9834 | 0.9796 | 0.9757 |
|                    512 | 0.9786 | 0.9831 | 0.9839 |
|                   1024 | 0.9786 | 0.9850 | 0.9896 |
|                   2048 | 0.9786 | 0.9879 | 0.9877 |


### Best configuration by F1-score (NF-BoT-IoT-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |           32 |              9 |      0.9914 |   0.9998 |     0.9956 |
| integer |         1024 |             13 |      0.9795 |   0.9999 |     0.9896 |



## NF-CSE-CIC-IDS2018-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 1.0000 | 1.0000 | 1.0000 |
|                     64 | 1.0000 | 1.0000 | 1.0000 |
|                    128 | 1.0000 | 1.0000 | 1.0000 |
|                    256 | 1.0000 | 1.0000 | 1.0000 |
|                    512 | 1.0000 | 1.0000 | 1.0000 |
|                   1024 | 1.0000 | 1.0000 | 1.0000 |
|                   2048 | 1.0000 | 1.0000 | 1.0000 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9579 | 0.9599 | 0.9599 |
|                     64 | 0.9595 | 0.9617 | 0.9625 |
|                    128 | 0.9602 | 0.9640 | 0.9648 |
|                    256 | 0.9626 | 0.9651 | 0.9653 |
|                    512 | 0.9629 | 0.9653 | 0.9655 |
|                   1024 | 0.9637 | 0.9655 | 0.9657 |
|                   2048 | 0.9637 | 0.9655 | 0.9658 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9785 | 0.9795 | 0.9795 |
|                     64 | 0.9793 | 0.9805 | 0.9809 |
|                    128 | 0.9797 | 0.9817 | 0.9820 |
|                    256 | 0.9809 | 0.9823 | 0.9823 |
|                    512 | 0.9811 | 0.9823 | 0.9824 |
|                   1024 | 0.9815 | 0.9824 | 0.9825 |
|                   2048 | 0.9815 | 0.9824 | 0.9826 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 1.0000 | 1.0000 | 1.0000 |
|                     64 | 1.0000 | 1.0000 | 1.0000 |
|                    128 | 1.0000 | 1.0000 | 1.0000 |
|                    256 | 1.0000 | 1.0000 | 1.0000 |
|                    512 | 1.0000 | 1.0000 | 1.0000 |
|                   1024 | 1.0000 | 1.0000 | 1.0000 |
|                   2048 | 1.0000 | 1.0000 | 1.0000 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9554 | 0.9577 | 0.9596 |
|                     64 | 0.9591 | 0.9607 | 0.9621 |
|                    128 | 0.9608 | 0.9642 | 0.9648 |
|                    256 | 0.9627 | 0.9650 | 0.9652 |
|                    512 | 0.9631 | 0.9652 | 0.9655 |
|                   1024 | 0.9638 | 0.9654 | 0.9657 |
|                   2048 | 0.9637 | 0.9654 | 0.9658 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9772 | 0.9784 | 0.9793 |
|                     64 | 0.9791 | 0.9799 | 0.9807 |
|                    128 | 0.9800 | 0.9818 | 0.9821 |
|                    256 | 0.9810 | 0.9822 | 0.9823 |
|                    512 | 0.9812 | 0.9823 | 0.9824 |
|                   1024 | 0.9816 | 0.9824 | 0.9825 |
|                   2048 | 0.9815 | 0.9824 | 0.9826 |


### Best configuration by F1-score (NF-CSE-CIC-IDS2018-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |         2048 |             13 |      1.0000 |   0.9658 |     0.9826 |
| integer |         2048 |             13 |      1.0000 |   0.9658 |     0.9826 |



## NF-ToN-IoT-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9476 | 0.9634 | 0.9706 |
|                     64 | 0.9666 | 0.9756 | 0.9776 |
|                    128 | 0.9770 | 0.9807 | 0.9837 |
|                    256 | 0.9844 | 0.9867 | 0.9878 |
|                    512 | 0.9869 | 0.9892 | 0.9900 |
|                   1024 | 0.9890 | 0.9907 | 0.9920 |
|                   2048 | 0.9911 | 0.9924 | 0.9930 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9958 | 0.9939 | 0.9917 |
|                     64 | 0.9969 | 0.9948 | 0.9955 |
|                    128 | 0.9979 | 0.9972 | 0.9966 |
|                    256 | 0.9981 | 0.9977 | 0.9976 |
|                    512 | 0.9986 | 0.9982 | 0.9980 |
|                   1024 | 0.9989 | 0.9985 | 0.9984 |
|                   2048 | 0.9990 | 0.9987 | 0.9986 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9711 | 0.9784 | 0.9810 |
|                     64 | 0.9815 | 0.9851 | 0.9865 |
|                    128 | 0.9873 | 0.9889 | 0.9901 |
|                    256 | 0.9912 | 0.9922 | 0.9927 |
|                    512 | 0.9927 | 0.9937 | 0.9940 |
|                   1024 | 0.9939 | 0.9946 | 0.9952 |
|                   2048 | 0.9950 | 0.9955 | 0.9958 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9368 | 0.9575 | 0.9665 |
|                     64 | 0.9617 | 0.9686 | 0.9697 |
|                    128 | 0.9723 | 0.9768 | 0.9784 |
|                    256 | 0.9770 | 0.9803 | 0.9813 |
|                    512 | 0.9806 | 0.9835 | 0.9844 |
|                   1024 | 0.9826 | 0.9859 | 0.9866 |
|                   2048 | 0.9844 | 0.9865 | 0.9872 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9972 | 0.9924 | 0.9917 |
|                     64 | 0.9967 | 0.9956 | 0.9959 |
|                    128 | 0.9976 | 0.9967 | 0.9965 |
|                    256 | 0.9980 | 0.9970 | 0.9970 |
|                    512 | 0.9983 | 0.9975 | 0.9973 |
|                   1024 | 0.9986 | 0.9979 | 0.9977 |
|                   2048 | 0.9987 | 0.9981 | 0.9979 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9661 | 0.9747 | 0.9789 |
|                     64 | 0.9789 | 0.9819 | 0.9826 |
|                    128 | 0.9848 | 0.9867 | 0.9874 |
|                    256 | 0.9874 | 0.9886 | 0.9891 |
|                    512 | 0.9893 | 0.9904 | 0.9908 |
|                   1024 | 0.9905 | 0.9919 | 0.9921 |
|                   2048 | 0.9915 | 0.9923 | 0.9925 |


### Best configuration by F1-score (NF-ToN-IoT-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |         2048 |             13 |      0.9930 |   0.9986 |     0.9958 |
| integer |         2048 |             13 |      0.9872 |   0.9979 |     0.9925 |



## NF-UNSW-NB15-v2

### Mode: float

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9991 | 0.9984 | 0.9982 |
|                     64 | 0.9992 | 0.9985 | 0.9984 |
|                    128 | 0.9992 | 0.9987 | 0.9986 |
|                    256 | 0.9992 | 0.9988 | 0.9987 |
|                    512 | 0.9992 | 0.9989 | 0.9987 |
|                   1024 | 0.9993 | 0.9989 | 0.9987 |
|                   2048 | 0.9993 | 0.9989 | 0.9987 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.8736 | 0.9686 | 0.9747 |
|                     64 | 0.8906 | 0.9664 | 0.9712 |
|                    128 | 0.8928 | 0.9612 | 0.9682 |
|                    256 | 0.9117 | 0.9582 | 0.9670 |
|                    512 | 0.9004 | 0.9543 | 0.9667 |
|                   1024 | 0.8698 | 0.9540 | 0.9663 |
|                   2048 | 0.8709 | 0.9535 | 0.9666 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9322 | 0.9833 | 0.9863 |
|                     64 | 0.9418 | 0.9822 | 0.9846 |
|                    128 | 0.9430 | 0.9796 | 0.9832 |
|                    256 | 0.9535 | 0.9781 | 0.9826 |
|                    512 | 0.9473 | 0.9761 | 0.9825 |
|                   1024 | 0.9300 | 0.9759 | 0.9822 |
|                   2048 | 0.9307 | 0.9757 | 0.9824 |


### Mode: integer

#### Precision

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9991 | 0.9984 | 0.9982 |
|                     64 | 0.9992 | 0.9986 | 0.9985 |
|                    128 | 0.9992 | 0.9987 | 0.9986 |
|                    256 | 0.9992 | 0.9988 | 0.9986 |
|                    512 | 0.9992 | 0.9988 | 0.9987 |
|                   1024 | 0.9992 | 0.9989 | 0.9987 |
|                   2048 | 0.9993 | 0.9989 | 0.9987 |


#### Recall

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.8781 | 0.9666 | 0.9738 |
|                     64 | 0.8835 | 0.9653 | 0.9713 |
|                    128 | 0.8956 | 0.9632 | 0.9706 |
|                    256 | 0.9066 | 0.9603 | 0.9682 |
|                    512 | 0.9036 | 0.9561 | 0.9672 |
|                   1024 | 0.8668 | 0.9542 | 0.9670 |
|                   2048 | 0.8649 | 0.9546 | 0.9672 |


#### F1 Score

|   num\_leaves \ n\_est |    n=5 |    n=9 |   n=13 |
|-----------------------:|-------:|-------:|-------:|
|                     32 | 0.9347 | 0.9823 | 0.9859 |
|                     64 | 0.9378 | 0.9817 | 0.9847 |
|                    128 | 0.9446 | 0.9806 | 0.9844 |
|                    256 | 0.9506 | 0.9792 | 0.9832 |
|                    512 | 0.9490 | 0.9770 | 0.9827 |
|                   1024 | 0.9283 | 0.9760 | 0.9826 |
|                   2048 | 0.9273 | 0.9762 | 0.9827 |


### Best configuration by F1-score (NF-UNSW-NB15-v2)

| mode    |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:--------|-------------:|---------------:|------------:|---------:|-----------:|
| float   |           32 |             13 |      0.9982 |   0.9747 |     0.9863 |
| integer |           32 |             13 |      0.9982 |   0.9738 |     0.9859 |



## Overall Best Model per Dataset

| dataset               | mode   |   num_leaves |   n_estimators |   precision |   recall |   f1_score |
|:----------------------|:-------|-------------:|---------------:|------------:|---------:|-----------:|
| NF-BoT-IoT-v2         | float  |           32 |              9 |      0.9914 |   0.9998 |     0.9956 |
| NF-CSE-CIC-IDS2018-v2 | float  |         2048 |             13 |      1.0000 |   0.9658 |     0.9826 |
| NF-ToN-IoT-v2         | float  |         2048 |             13 |      0.9930 |   0.9986 |     0.9958 |
| NF-UNSW-NB15-v2       | float  |           32 |             13 |      0.9982 |   0.9747 |     0.9863 |

